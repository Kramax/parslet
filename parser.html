<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html;charset=UTF-8" http-equiv="Content-type" />
    <title>
      parslet -
      Parser construction
    </title>
    <meta content="Kaspar Schiess (http://absurd.li)" name="author" />
    <link href="css/site.css" rel="stylesheet" type="text/css" />
    <link href="css/pygments.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <div id="everything">
      <div class="main_menu">
        <img alt="Parslet Logo" src="imgs/parsley_logo.png" />
        <ul>
          <li><a href="index.html">about</a></li>
          <li><a href="get-started.html">get started</a></li>
          <li><a href="install.html">install</a></li>
          <li><a href="documentation.html">documentation</a></li>
          <li><a href="contribute.html">contribute</a></li>
        </ul>
      </div>
      <div class="content">
        <h1>Parser construction</h1>
        <p>A parser is nothing more than a class that derives from
        <code>Parslet::Parser</code>. The simplest parser that one could write would
        look like this:</p>
        <div class="highlight"><pre><code class="ruby"> 
        <span class="k">class</span> <span class="nc">SimpleParser</span> <span class="o">&lt;</span> <span class="no">Parslet</span><span class="o">::</span><span class="no">Parser</span>
          <span class="n">rule</span><span class="p">(</span><span class="ss">:a_rule</span><span class="p">)</span> <span class="p">{</span> <span class="n">str</span><span class="p">(</span><span class="s1">&#39;simple_parser&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="n">root</span><span class="p">(</span><span class="ss">:a_rule</span><span class="p">)</span>
        <span class="k">end</span>
        </code></pre>
        </div><p>The language recognized by this parser is simply the string &#8220;simple_parser&#8221;. 
        Parser rules do look a lot like methods and are defined by</p>
        <div class="highlight"><pre><code class="ruby"> 
        <span class="n">rule</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span> <span class="p">{</span> <span class="n">definition_block</span> <span class="p">}</span>
        </code></pre>
        </div><p>Behind the scenes, this really defines a method that returns whatever you 
        return from it.</p>
        <p>Every parser has a root. This designates where parsing should start. It is like
        an entry point to your parser. With a root defined like this:</p>
        <div class="highlight"><pre><code class="ruby"> 
        <span class="n">root</span><span class="p">(</span><span class="ss">:my_root</span><span class="p">)</span>
        </code></pre>
        </div><p>you create a <code>#parse</code> method in your parser that will start parsing
        by calling the <code>#my_root</code> method. You&#8217;ll also have a <code>#root</code>
        (instance) method that is an alias of the root method. The following things are
        really one and the same:</p>
        <div class="highlight"><pre><code class="ruby"> 
        <span class="no">SimpleParser</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="no">SimpleParser</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="no">SimpleParser</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">a_rule</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        </code></pre>
        </div><p>(If you are wondering what this <code>SimpleParser</code> is about, scroll
        right to the top of the page). Knowing these things gives you a lot of 
        flexibility; I&#8217;ll explain why at the end of the chapter. For now, just let me
        point out that because all of this is Ruby, your favorite editor will syntax
        highlight parser code just fine.</p>
        <h2>Atoms: The inside of a parser</h2>
        <p>A parser is constructed from parser atoms (or parslets, hence the name). The
        atoms are what appear inside your rules (and maybe elsewhere). We&#8217;ve already
        encountered an atom, the string atom:</p>
        <div class="highlight"><pre><code class="ruby"> 
        <span class="n">str</span><span class="p">(</span><span class="s1">&#39;simple_parser&#39;</span><span class="p">)</span>
        </code></pre>
        </div>
      </div>
      <div class="copyright">
        <p><span class="caps">MIT</span> License, 2010, &#169; <a href="http://absurd.li">Kaspar Schiess</a><br/>
        Logo by <a href="http://floere.github.com">Florian Hanke</a>, <a href="http://creativecommons.org/licenses/by/1.0/">CC Attribution</a> license</p>
      </div>
      <script type="text/javascript">
        //<![CDATA[
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-16365074-2']);
          _gaq.push(['_trackPageview']);
          
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        //]]>
      </script>
    </div>
  </body>
</html>
